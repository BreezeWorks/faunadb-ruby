<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>README - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-FaunaDB">FaunaDB</a>
    <li><a href="#label-Installation">Installation</a>
    <li><a href="#label-Documentation">Documentation</a>
    <li><a href="#label-Compatibility">Compatibility</a>
    <li><a href="#label-Basic+Usage">Basic Usage</a>
    <li><a href="#label-Creating+a+Client">Creating a Client</a>
    <li><a href="#label-Using+the+Client">Using the Client</a>
    <li><a href="#label-Running+Tests">Running Tests</a>
    <li><a href="#label-Contributing">Contributing</a>
    <li><a href="#label-LICENSE">LICENSE</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./README_md.html">README</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page README.md">

<h1 id="label-FaunaDB">FaunaDB<span><a href="#label-FaunaDB">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>Ruby driver for <a href="https://fauna.com">FaunaDB</a>.</p>

<h2 id="label-Installation">Installation<span><a href="#label-Installation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The FaunaDB ruby driver is distributed as a gem. Install it via:</p>

<pre>$ gem install fauna</pre>

<p>Or if you use Bundler, add it to your application&#39;s
<code>Gemfile</code>:</p>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-string">&#39;fauna&#39;</span>
</pre>

<p>And then execute:</p>

<pre>$ bundle</pre>

<h2 id="label-Documentation">Documentation<span><a href="#label-Documentation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The driver documentation is <a
href="https://faunadb.github.io/faunadb-ruby/">hosted on GitHub Pages</a>.</p>

<p>Please see the <a href="https://fauna.com/documentation">FaunaDB
Documentation</a> for a complete API reference, or look in <a
href="https://github.com/faunadb/faunadb-ruby/tree/master/test">/test</a>
for more examples.</p>

<h2 id="label-Compatibility">Compatibility<span><a href="#label-Compatibility">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Tested and compatible with the following ruby versions:</p>
<ul><li>
<p>MRI 1.9.3</p>
</li><li>
<p>MRI 2.2.3</p>
</li><li>
<p>Jruby 1.7.19</p>
</li></ul>

<h2 id="label-Basic+Usage">Basic Usage<span><a href="#label-Basic+Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>First, require the gem:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;fauna&#39;</span>
</pre>

<h3 id="label-Creating+a+Client">Creating a Client<span><a href="#label-Creating+a+Client">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>All API requests pass through a <code>Fauna::Client</code>. Creating a
client requires either an admin key, server key, client key, or a token.</p>

<pre class="ruby"><span class="ruby-identifier">server_key</span> = <span class="ruby-string">&#39;ls8AkXLdakAAAALPAJFy3LvQAAGwDRAS_Prjy6O8VQBfQAlZzwAA&#39;</span>
</pre>

<p>Now we can make a database-level client:</p>

<pre class="ruby"><span class="ruby-identifier">$fauna</span> = <span class="ruby-constant">Fauna</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">secret</span><span class="ruby-operator">:</span> <span class="ruby-identifier">server_key</span>)
</pre>

<p>You can optionally configure an <code>observer</code> on the client. To
ease debugging, we provide a simple logging observer at
<code>Fauna::ClientLogger.logger</code>, which you can configure as such:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;logger&#39;</span>
<span class="ruby-identifier">logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">STDERR</span>)
<span class="ruby-identifier">observer</span> = <span class="ruby-constant">Fauna</span><span class="ruby-operator">::</span><span class="ruby-constant">ClientLogger</span>.<span class="ruby-identifier">logger</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">log</span><span class="ruby-operator">|</span> <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-identifier">log</span>) }

<span class="ruby-identifier">$fauna</span> = <span class="ruby-constant">Fauna</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(
  <span class="ruby-identifier">secret</span><span class="ruby-operator">:</span> <span class="ruby-identifier">server_key</span>,
  <span class="ruby-identifier">observer</span><span class="ruby-operator">:</span> <span class="ruby-identifier">observer</span>)
</pre>

<h3 id="label-Using+the+Client">Using the Client<span><a href="#label-Using+the+Client">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Now that we have a client, we can start performing queries:</p>

<pre class="ruby"><span class="ruby-comment"># Create a class</span>
<span class="ruby-identifier">$fauna</span>.<span class="ruby-identifier">query</span> { <span class="ruby-identifier">create</span> <span class="ruby-identifier">ref</span>(<span class="ruby-string">&#39;classes&#39;</span>), <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;users&#39;</span> }

<span class="ruby-comment"># Create an instance of the class</span>
<span class="ruby-identifier">taran</span> = <span class="ruby-identifier">$fauna</span>.<span class="ruby-identifier">query</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">create</span> <span class="ruby-identifier">ref</span>(<span class="ruby-string">&#39;classes/users&#39;</span>), <span class="ruby-identifier">data</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">email</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;taran@example.com&#39;</span> }
<span class="ruby-keyword">end</span>

<span class="ruby-comment"># Update the instance</span>
<span class="ruby-identifier">taran</span> = <span class="ruby-identifier">$fauna</span>.<span class="ruby-identifier">query</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">update</span> <span class="ruby-identifier">taran</span>[:<span class="ruby-identifier">ref</span>], <span class="ruby-identifier">data</span><span class="ruby-operator">:</span> {
    <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Taran&#39;</span>,
    <span class="ruby-identifier">profession</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Pigkeeper&#39;</span>
  }
<span class="ruby-keyword">end</span>

<span class="ruby-comment"># Page through a set</span>
<span class="ruby-identifier">pigkeepers</span> = <span class="ruby-constant">Fauna</span><span class="ruby-operator">::</span><span class="ruby-constant">Query</span>.<span class="ruby-identifier">expr</span> { <span class="ruby-identifier">match</span>(<span class="ruby-identifier">ref</span>(<span class="ruby-string">&#39;indexes/users_by_profession&#39;</span>), <span class="ruby-string">&#39;Pigkeeper&#39;</span>) }
<span class="ruby-identifier">oracles</span> = <span class="ruby-constant">Fauna</span><span class="ruby-operator">::</span><span class="ruby-constant">Query</span>.<span class="ruby-identifier">expr</span> { <span class="ruby-identifier">match</span>(<span class="ruby-identifier">ref</span>(<span class="ruby-string">&#39;indexes/users_by_profession&#39;</span>), <span class="ruby-string">&#39;Oracle&#39;</span>) }

<span class="ruby-identifier">$fauna</span>.<span class="ruby-identifier">query</span> { <span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">union</span>(<span class="ruby-identifier">pigkeepers</span>, <span class="ruby-identifier">oracles</span>)) }

<span class="ruby-comment"># Delete the user</span>
<span class="ruby-identifier">$fauna</span>.<span class="ruby-identifier">query</span> { <span class="ruby-identifier">delete</span> <span class="ruby-identifier">user</span>[:<span class="ruby-identifier">ref</span>] }
</pre>

<h2 id="label-Running+Tests">Running Tests<span><a href="#label-Running+Tests">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>You can run tests against FaunaDB Cloud yourself. <a
href="https://fauna.com/account/keys">Create an admin key</a> and set
<code>FAUNA_ROOT_KEY</code> environment variable to it&#39;s secret. Then
run <code>rake test</code>:</p>

<pre class="ruby"><span class="ruby-identifier">export</span> <span class="ruby-constant">FAUNA_ROOT_KEY</span>=<span class="ruby-string">&#39;kqnPAbijGhkgAAC03-36hjCvcTnWf4Pl8w97UE1HeWo&#39;</span>
<span class="ruby-identifier">rake</span> <span class="ruby-identifier">test</span>
</pre>

<p>To run a single test, use e.g. <code>ruby test/client_test.rb</code>.</p>

<p>Coverage is automatically run as part of the tests. After running tests,
check <code>coverage/index.html</code> for the coverage report. If using
jruby, use <code>JRUBY_OPTS=&quot;--debug&quot; bundle exec rake
test</code> to ensure coverage is generated correctly.</p>

<h2 id="label-Contributing">Contributing<span><a href="#label-Contributing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>GitHub pull requests are very welcome.</p>

<h2 id="label-LICENSE">LICENSE<span><a href="#label-LICENSE">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Copyright 2016 <a href="https://fauna.com/">Fauna, Inc.</a></p>

<p>Licensed under the Mozilla Public License, Version 2.0 (the “License”); you
may not use this software except in compliance with the License. You may
obtain a copy of the License at</p>

<p><a href="http://mozilla.org/MPL/2.0/">mozilla.org/MPL/2.0/</a></p>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations
under the License.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

